category: Analytics & SIEM
commonfields:
  id: RecordedFutureAlerts
  version: -1
image: data:image/png;base64,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
configuration:

- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
  section: Collect

- display: Incident type
  name: incidentType
  defaultvalue: "Recorded Future Alert"
  type: 13
  required: false
  section: Collect

- defaultvalue: https://api.recordedfuture.com/gw/xsoar/
  display: Your server URL
  name: url
  required: true
  type: 0

- display: API Key
  additionalinfo: The API Key to use for the connection
  name: apikey
  required: true
  type: 4

- name: integrationReliability
  display: 'Source Reliability'
  defaultvalue: B - Usually reliable
  options:
    - A+ - 3rd party enrichment
    - A - Completely reliable
    - B - Usually reliable
    - C - Fairly reliable
    - D - Not usually reliable
    - E - Unreliable
    - F - Reliability cannot be judged
  type: 15
  required: false
  additionalinfo: Reliability of the source providing the intelligence data.
  section: Collect


- display: Incidents fetch interval
  defaultvalue: '1'
  name: incidentFetchInterval
  type: 19
  required: false
  section: Collect

- display: Maximum number of incidents per fetch
  name: max_fetch
  defaultvalue: "50"
  type: 0
  required: false
  section: Collect

- display: 'First fetch time'
  additionalinfo: 'How far back we should fetch alerts on the first incident fetch. This value is not used for subsequent fetches.'
  defaultvalue: '1440' # 1 day
  name: first_fetch
  type: 19
  required: false
  section: Collect


- display: 'Enable Classic Alerts'
  name: classic_alerts_enabled
  type: 8
  defaultvalue: true
  required: false
  section: Collect

- display: 'Classic Alerts: Rule names to fetch'
  name: classic_alert_rules
  type: 12
  additionalinfo: 'Rule names to fetch alerts by, separated by semicolon. If empty, all alerts will be fetched.'
  required: false

- display: 'Classic Alerts: Statuses to fetch'
  name: classic_alert_statuses
  type: 16
  defaultvalue: New
  options:
  - New
  - Resolved
  - Dismissed
  - InProgress
  required: false
  section: Collect


- display: 'Enable Playbook Alerts'
  name: playbook_alerts_enabled
  type: 8
  defaultvalue: true
  required: false
  section: Collect

- display: 'Playbook Alerts: Priority to fetch'
  name: playbook_alert_priority
  type: 15
  defaultvalue: Moderate
  additionalinfo: 'Fetch playbook alerts with this priority and higher'
  options:
    - Informational
    - Moderate
    - High
  required: false
  section: Collect

- display: 'Playbook Alerts: Categories to fetch'
  name: playbook_alert_categories
  additionalinfo: 'Playbook Alert categories to filter by. If empty, all alerts will be fetched. Note that your Recorded Future licensing also affects which Playbook Alerts are available.'
  type: 16
  defaultvalue: ''
  options:
  - domain_abuse
  - vulnerability
  - code_repo_leakage
  - third_party_risk
  required: false
  section: Collect

- display: 'Playbook Alerts: Statuses to fetch'
  name: playbook_alert_statuses
  type: 16
  defaultvalue: New
  options:
  - New
  - Resolved
  - Dismissed
  - InProgress
  required: false
  section: Collect


- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8

description: 'Fetch and triage alerts from Recorded Future'
display: Recorded Future Alerts
name: RecordedFutureAlerts
script:
  commands:
    - name: recordedfuture-alert-images
      description: Fetch alert images.
      arguments:
      outputs:
        - contextPath: RecordedFuture.attachment
          description: "Fetch new alert images."
          type: Unknown

    - name: recordedfuture-alert-rules
      description: Search for alert rule IDs.
      arguments:
        - name: rule_name
          description: Rule name to search. Can be a partial name.
        - name: limit
          description: 'Maximum number of rules to return. Default is 10.'
          defaultValue: "10"
      outputs:
        - contextPath: RecordedFuture.AlertRule.id
          description: Alert rule ID.
          type: string
        - contextPath: RecordedFuture.AlertRule.name
          description: Alert rule name.
          type: string

#    - name: recordedfuture-alerts
#      description: Gets details on alerts configured and generated by Recorded Future by alert rule ID and/or time range.
#      arguments:
#      - name: rule_id
#        description: Alert rule ID.
#      - name: limit
#        description: Maximum number of alerts to return. Default is 10.
#        defaultValue: "10"
#      - name: triggered_time
#        description: 'Alert triggered time, e.g., "1 hour" or "2 days".'
#      - name: assignee
#        description: 'Alert assignee''s email address.'
#      - name: status
#        auto: PREDEFINED
#        predefined:
#        - unassigned
#        - assigned
#        - pending
#        - actionable
#        - no-action
#        - tuning
#        description: 'Alert review status. Can be "unassigned", "assigned", "pending", "actionable", "no-action", or "tuning".'
#      - name: freetext
#        description: Free text search.
#      - name: offset
#        description: Alerts from offset.
#      - name: orderby
#        auto: PREDEFINED
#        predefined:
#        - triggered
#        description: Alerts sort order.
#      - name: direction
#        auto: PREDEFINED
#        predefined:
#        - asc
#        - desc
#        description: The direction by which to sort alerts. Can be "asc" or "desc".
#      outputs:
##        - TODO: this needs to be updated to the new common alert schema
#      - contextPath: RecordedFuture.Alert.id
#        description: Alert ID.
#        type: string
#      - contextPath: RecordedFuture.Alert.name
#        description: Alert name.
#        type: string
#      - contextPath: RecordedFuture.Alert.type
#        description: Alert type.
#        type: string
#      - contextPath: RecordedFuture.Alert.triggered
#        description: Alert triggered time.
#        type: date
#      - contextPath: RecordedFuture.Alert.status
#        description: Alert status.
#        type: string
#      - contextPath: RecordedFuture.Alert.assignee
#        description: Alert assignee.
#        type: string
#      - contextPath: RecordedFuture.Alert.rule
#        description: Alert rule name.
#        type: string

#    - name: recordedfuture-playbook-alert-update
#      description: Update the status of one or multiple Playbook alerts.
#      arguments:
#        - name: alert_ids
#          required: true
#          description: Ids of the playbook alerts that will be updated.
#        - name: new_status
#          description: New status to set for all alerts in alert_ids.
#          required: true
#          auto: PREDEFINED
#          predefined:
#            - new
#            - in-progress
#            - dismissed
#            - resolved
#        - name: comment
#          description: Add comment to all alerts in alert_ids.
#          required: false
#        - name: reopen
#          description: 'Set the reopen strategy for the alert. Reopen on significant updates or keep the alert Resolved. Default: reopen on significant updates. Can only be used with new_status=resolved.'
#          required: false
#          auto: PREDEFINED
#          predefined:
#            - never
#            - significant_updates
#      outputs:
#        - contextPath: RecordedFuture.PlaybookAlerts.playbook_alert_id
#          description: Unique id of the playbook alert in Recorded Future.
#          type: string
#        - contextPath: RecordedFuture.PlaybookAlerts.current_status
#          description: Current status of playbook alert in Recorded Future.
#          type: string
#        - contextPath: RecordedFuture.PlaybookAlerts.title
#          description: Title of the playbook alert in Recorded Future.
#          type: string
#        - contextPath: RecordedFuture.PlaybookAlerts.status_message
#          description: Message describing the outcome of the update.
#          type: string
#

  isfetch: true
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.9.8.24399
fromversion: 6.1.0
marketplaces:
- xsoar
- marketplacev2
tests:
- No tests (auto formatted)
